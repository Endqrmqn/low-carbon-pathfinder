<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leaderboard</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background: #f0f0f0;
        }

        .leaderboard-title {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .first { background: #ffcc00; }
        .second { background: #a6a6a6; }
        .third { background: #cc6600; }

        .leaderboard {
            width: 300px;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            background: #ffffff;
        }

        .leaderboard-item {
            display: flex;
            align-items: center;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 10px;
            background: #e9e9e9;
        }

        .leaderboard-item:last-child { margin-bottom: 0; }

        .rank-container {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 40px;
            height: 40px;
            margin-right: 15px;
            position: relative;
        }

        .crown {
            position: absolute;
            top: -20px;
            font-size: 1.2em;
            color: gold;
        }

        .rank {
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.2em;
            border-radius: 50%;
            color: #ffffff;
        }

        .name, .score { flex: 1; text-align: center; }
    </style>
</head>
<body>
    <h1 class="leaderboard-title">WorldWide Leaderboard</h1>
    <div class="leaderboard" id="leaderboard">
        <!-- Leaderboard items will be inserted here -->
    </div>

    <script>
        async function loadLeaderboard() {
            try {
                // Fetch the JSON file (replace 'users_with_real_names.json' with the correct file path)
                const response = await fetch('users_with_real_names.json');
                const data = await response.json();

                // Convert JSON object to an array
                const usersArray = Object.entries(data).map(([name, info]) => ({
                    name: name,
                    total_co2_savings_kg: info.total_co2_savings_kg
                }));

                // Sort users by COâ‚‚ savings in descending order
                usersArray.sort((a, b) => b.total_co2_savings_kg - a.total_co2_savings_kg);

                // Select the leaderboard container
                const leaderboardContainer = document.getElementById("leaderboard");

                // Loop through users and create leaderboard elements
                usersArray.forEach((user, index) => {
                    const item = document.createElement("div");
                    item.classList.add("leaderboard-item");

                    // Assign special colors to top 3
                    let rankClass = "";
                    if (index === 0) rankClass = "first";
                    else if (index === 1) rankClass = "second";
                    else if (index === 2) rankClass = "third";

                    // Crown for first place
                    const crown = index === 0 ? `<span class="crown">ðŸ‘‘</span>` : "";

                    item.innerHTML = `
                        <div class="rank-container">
                            ${crown}
                            <div class="rank circle ${rankClass}">${index + 1}</div>
                        </div>
                        <div class="name">${user.name}</div>
                        <div class="score">${user.total_co2_savings_kg.toFixed(2)} kg COâ‚‚</div>
                    `;

                    leaderboardContainer.appendChild(item);
                });
            } catch (error) {
                console.error("Error loading leaderboard:", error);
            }
        }

        // Load the leaderboard when the page loads
        window.onload = loadLeaderboard;
    </script>
</body>
</html>
